<script type="text/javascript">
    RED.nodes.registerType('you-layerone2-auth',{
      category: 'LayerOne2',
      color:"#139ce9",
      defaults: {
        layerone: { value: "", type: 'you-layerone2'},
        name: {value: ''},
        entity: {value: ''},
        entitydynamics: {value : ''},
        configsid: {value : '', validate: (v) => true},
        paramsprops: {value : '', validate: (v) => true }
      },
      inputs:1,
      outputs:1,
      icon: 'font-awesome/fa-lock',
      paletteLabel: "Authenticate",
      label: function() {
        return this.name||"LayerOne2 authenticate";
      },
      oneditprepare: function () {
        $("#node-input-configsid").typedInput({
        type:"msg",
        types:["msg"],
        typeField: "#node-input-configsid-type",
        value: 'configsid'
      });
        $("#node-input-paramsprops").typedInput({
        type:"msg",
        types:["msg"],
        typeField: "#node-input-paramsprops-type",
        value: 'paramsprops'
      });
      
        jQuery("#node-input-entity").change(function() {
          jQuery('#node-entitydynamics').hide();
          jQuery('#node-configsid').hide();
          jQuery('#node-params').hide();
          
          if (jQuery(this).val() === 'Static'){ 
              jQuery('#node-staticlogin').show();
              jQuery('#node-entitydynamics').hide();
               jQuery('#node-configsid').hide();
                jQuery('#node-params').hide();
          }
          else if(jQuery(this).val() === 'Dynamics'){
              jQuery('#node-staticlogin').hide();
              jQuery('#node-entitydynamics').show();
               jQuery('#node-configsid').show();
                
          }
        });

        jQuery("#node-input-entitydynamics").change(function() {
          jQuery('#node-configsid').hide();
          jQuery('#node-params').hide();
          if (jQuery(this).val() === 'Configs'){ 
              jQuery('#node-configsid').show();
              jQuery('#node-params').hide();
          }
          else if(jQuery(this).val() === 'Params'){
              jQuery('#node-configsid').hide();
              jQuery('#node-params').show();
          }
        });

      }
    });
  </script>
    
  <script type="text/html" data-template-name="you-layerone2-auth">
    <div class="form-row">
       <label for="node-input-type"><i class="fa fa-cube"></i> Login Type</label>
        <select name="node-input-entity" id="node-input-entity">
          <option value="Static">Static configured</option>
          <option value="Dynamics">Dynamics configured</option>
        </select>
      </div>
      <!-- Dynamic Login -->

      <div class="form-row" id="node-entitydynamics" style="display:none">
       <label for="node-input-type-entitydynamics"><i class="fa fa-cube"></i> Dynamics Type</label>
        <select name="node-input-entitydynamics" id="node-input-entitydynamics">
          <option value="Configs">Dynamics Configuration</option>
          <option value="Params">Dynamics Params</option>
        </select>
      </div>

      <div id="node-configsid">
          <div class="form-row" >
            <label for="node-input-configsid"><i class="fa fa-gears"></i>Props Configs ID</label>
            <input type="text" id="node-input-configsid">
            <input type="hidden" id="node-input-configsid-type">
          </div>
          <div>
          <p>
            Exsample props Configs
          </p>
          <pre>
            <code>
              msg.params = {
                config: "482172cc252e1e69"
              }
            </code>
          </pre>
        </div>
      </div>
       

        <div id="node-params">
        <div class="form-row" id="node-paramsprops">
          <label for="node-input-paramsprops"><i class="fa fa-gears"></i> Props Params</label>
          <input type="text" id="node-input-paramsprops">
          <input type="hidden" id="node-input-paramsprops-type">
        </div>

        <div>
          <p>
            Exsample props Params
          </p>
          <pre>
            <code>
              msg.params = {
                  "protocol": "https",
                  "host": "localhost",
                  "port": "5051",
                  "version": "v1",
                  "databaseName": "SBODemoIT",
                  "companyUser": "manager",
                  "companyPassword": "sapb1",
                  "consumerIdentity": "NTH"
              }
            </code>
          </pre>
        </div>
        </div>

      <!-- END Dynamics Login --> 
      <!-- STATIC LOGIN -->
    <div class="form-row" id="node-staticlogin">
        <label for="node-input-layerone"><i class="fa fa-lock"></i> Configs</label>
        <input type="text" id="node-input-layerone">
    </div>
    <!-- END STATIC LOGING-->
    <div class="form-row">
      <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
      <input type="text" id="node-input-name" placeholder="Name">
    </div>
  </script>

  <!-- Documentation -->
  <script type="text/html" data-help-name="you-layerone2-auth">
    <p>Authenticate action</p>
    <h3>Inputs</h3>
        <dl class="message-properties">
            <dt>Name
              <span class="property-type">string</span>
            </dt>
            <dd> the node's name </dd>
            <dt>Host
              <span class="property-type">string</span>
            </dt>
            <dd> Service layer's hostname </dd>
            <dt>Port
              <span class="property-type">number</span>
            </dt>
            <dd> Service layer's port </dd>
            <dt>Company
              <span class="property-type">string</span>
            </dt>
            <dd> Company's name to connect </dd>
            <dt>User
              <span class="property-type">string</span>
            </dt>
            <dd>Username to connect to the company's database </dd>
            <dt>Password
              <span class="property-type">string</span>
            </dt>
            <dd>Password to connect to the company's database </dd>
  
        </dl>
    
     <h3>Outputs</h3>
         <ol class="node-ports">
             <li>Standard output
                 <dl class="message-properties">
                     <dt>payload <span class="property-type">string</span></dt>
                     <dd>the standard output of the command.</dd>
                 </dl>
             </li>
         </ol>
    
    <h3>Details</h3>
        <p>this node is used to authenticate to the service layer.
          See the examples to understand how to use it.
        </p>
        <!-- <p><code>msg.payload</code> is used as the payload of the published message.
        If it contains an Object it will be converted to a JSON string before being sent.
        If it contains a binary Buffer the message will be published as-is.</p>
        <p>The topic used can be configured in the node or, if left blank, can be set
        by <code>msg.topic</code>.</p>
        <p>Likewise the QoS and retain values can be configured in the node or, if left
        blank, set by <code>msg.qos</code> and <code>msg.retain</code> respectively.</p> -->
    
    <h3>References</h3>
        <ul>
            <li><a href="https://sap-samples.github.io/smb-summit-hackathon/b1sl.html" target="_black">Service layer API docs</a> - for more details </li>
            <li><a href="https://github.com/yousolution-cloud/node-red-contrib-you-sap-service-layer">@yousolution-cloud/node-red-contrib-you-sap-service-layer</a> - the nodes github repository</li>
        </ul>
  </script>